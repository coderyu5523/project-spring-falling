{{>layout/header}}

<br>
<div class="artist-song-list-main-container">
    <div class="artist-song-list-contents">
        <div class="artist-song-list-album">
            <br>
            <div class="artist-song-list-result-item">
                <input type="hidden" id="artist-id" value="{{artist.artistId}}">
                <div class="artist-song-list-album-cover">
                    <a href="#">
                        <img src="{{artist.artistImage}}" alt="artistImage">
                    </a>
                    <div>
                        <a href="#"><i class="artist-song-list-play-btn fas fa-solid fa-circle-play"></i></a>
                    </div>
                </div>
                <div class="artist-song-list-result-info">
                    <a href="#">
                        <h3 style="font-weight: 600;">{{artist.artistName}}</h3>
                    </a>
                    <div class="artist-song-list-album-info">
                        <p class="artist-song-list-album-category">{{artist.artistType}} | {{artist.artistGenre}}</p>
                    </div>

                    <div class="artist-song-list-info-icons">
                        {{#artist.isArtistLike}}
                            <a href="#"><i class="artist-song-list-btn-add-like fas fa-heart"></i></a>
                        {{/artist.isArtistLike}}
                        {{^artist.isArtistLike}}
                            <a href="#"><i class="artist-song-list-btn-add-like fa-regular fa-heart"></i></a>
                        {{/artist.isArtistLike}}
                        <a href="#" class="artist-song-list-title-play">
                            <i class="artist-song-list-title-play-btn fas fa-play play-button"></i>
                            <div class="artist-song-list-title-play-text">타이틀곡 듣기</div>
                        </a>
                    </div>
                </div>
            </div>
        </div>

        <br>
        <div class="artist-song-list-tab-button">
            <button class="artist-song-list-song-list">곡</button>
            <button class="artist-song-list-album-list">앨범</button>
        </div>
        <div class="artist-song-list-filter">
            <div class="artist-song-list-table-menu">
                <div class="artist-song-list-table-order">
                    <div class="artist-song-list-filter-album-category">
                        <p class="artist-song-list-all" data-keyword="전체">
                            전체
                        </p>
                        <p class="artist-song-list-album-category" data-keyword="정규/싱글">
                            정규/싱글
                        </p>
                        <p class="artist-song-list-participation" data-keyword="참여">
                            참여
                        </p>
                        <p>
                            |
                        </p>
                    </div>
                    <div class="artist-song-list-filter-order-by">
                        <p>
                            <a href="#" class="artist-song-list-order-by-date" data-keyword="최신순">최신순</a>
                        </p>
                        <p>
                            <a href="#" class="artist-song-list-order-by-popularity" data-keyword="인기순">인기순</a>
                        </p>
                        <p>
                            <a href="#" class="artist-song-list-order-by-korean" data-keyword="가나다순">가나다순</a>
                        </p>
                    </div>
                </div>
                <div>
                </div>
            </div>
        </div>
        <br>

        <div>
            <ul class="artist-song-list-album-list">

            </ul>
        </div>
    </div>
</div>
<br>
<script>
    $(document).ready(function () {
        // 초기화: 모든 옵션 초기화
        var selectedCategory = "";
        var selectedOrderBy = "";
        var artistId = $('#artist-id').val();

        // 전체, 정규/싱글, 참여 중 하나만 선택되도록 처리
        $('.artist-song-list-filter-album-category p').click(function (e) {
            e.preventDefault();
            var keyword = $(this).data('keyword');

            // 기존 선택 제거
            $('.artist-song-list-filter-album-category p').removeClass('active');
            $(this).addClass('active');

            // 선택된 카테고리 저장
            selectedCategory = keyword;

            // 필터링 함수 호출
            filterSongs(selectedCategory, selectedOrderBy);
        });

        // 최신순, 인기순, 가나다순 중 하나만 선택되도록 처리
        $('.artist-song-list-filter-order-by a').click(function (e) {
            e.preventDefault();
            var orderBy = $(this).data('orderby');

            // 기존 선택 제거
            $('.artist-song-list-filter-order-by a').removeClass('active');
            $(this).addClass('active');

            // 선택된 정렬 순서 저장
            selectedOrderBy = orderBy;

            // 필터링 함수 호출 (여기서는 예시로 console.log로 대체)
            filterSongs(selectedCategory, selectedOrderBy);
        });


        function filterSongs(category, orderBy) {
            console.log("Filtering songs by:", category, "Order by:", orderBy);
            getContent('/' + artistId + '/sort-and-filter', songs);
        }

        function getContent(url, pageCallback) {
            $.ajax({
                url: url,
                method: 'GET',
                dataType: 'json',
                data: selectedCategory + " " + selectedOrderBy,
                success: function (data) {
                    $("#artist-song-list-album-list").html(pageCallback(data.body))
                },
                error: function () {
                    alert("데이터 가져오기 실패");
                }
            })
        }

        // 노래 리스트
        function songs(body) {
            return body.map(item => {
                return `
                <li>
                    <div class="artist-song-list-badge-area">
                        <div class="artist-song-list-album-cover">
                            <img src="..${item.coverImg}" alt="Album Cover">
                                <a href="#"><i class="artist-song-list-play-btn fa fa-play"></i></a>
                        </div>
                        <div class="artist-song-list-album-info">
                            <div class="artist-song-list-info-area">
                                <a href="#"></a>
                                <p class="artist-song-list-album-title">${item.albumTitle}</p></a>
                            <a href="#"></a>
                            <p class="artist-song-list-album-artist">${item.artistName}></p></a>
                    </div>
                    <div class="artist-song-list-explain_area">
                        <div class="artist-song-list-album-category">
                            <p>${item.category}\</p>
                        </div>
                        <div class="artist-song-list-album-date">
                            <p>${item.createdAt}</p>
                        </div>
                    </div>
                    <div class="artist-song-list-icons">
                        <a href="#"><i class="artist-song-list-btn-add-list fas fa-list icon"></i></a>
                        <a href="#"><i
                                class="artist-song-list-btn-add-playlist fas fa-folder-plus custom-icon"></i></a>
                        <a href="#">
                            <i class="artist-song-list-btn-add-like fas fa-heart"></i>
                        </a>
                        <a href="#">
                            <i class="artist-song-list-btn-add-like fa-regular fa-heart"></i>
                        </a>
                    </div>
                </div>
            </div>
            </li>
                ;`
            }).join('');
        }
    });
</script>
{{>layout/footer}}